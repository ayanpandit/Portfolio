@tailwind base;
@tailwind components;
@tailwind utilities;

/**
 * ============================================
 * LENIS SMOOTH SCROLL - CSS REQUIREMENTS
 * ============================================
 * 
 * These styles are CRITICAL for Lenis to function correctly.
 * Do not modify without understanding the implications.
 */

/**
 * HTML Element Configuration
 * 
 * WHY NO scroll-behavior: smooth?
 * Lenis handles scrolling via JavaScript. CSS scroll-behavior
 * would fight against Lenis and cause jank/double scrolling.
 * 
 * height: 100% enables proper scroll calculation
 */
html {
  /* REMOVED: scroll-behavior: smooth - conflicts with Lenis */
  height: 100%;
}

/**
 * Lenis-specific body styles
 * 
 * CRITICAL RULES:
 * 1. min-height: 100% ensures body fills viewport
 * 2. overflow-x: clip (not hidden) prevents horizontal scroll
 *    while allowing sticky elements to work
 * 3. -webkit-overflow-scrolling is NOT needed with Lenis
 *    (it's for native momentum scrolling which we're replacing)
 */
html.lenis, html.lenis body {
  height: auto;
}

.lenis.lenis-smooth {
  scroll-behavior: auto !important;
}

.lenis.lenis-smooth [data-lenis-prevent] {
  overscroll-behavior: contain;
}

.lenis.lenis-stopped {
  overflow: hidden;
}

.lenis.lenis-smooth iframe {
  pointer-events: none;
}

body {
  background-color: black;
  overflow-x: clip; /* Better than hidden for sticky compatibility */
  min-height: 100%;
  /* Prevent pull-to-refresh on mobile */
  overscroll-behavior-y: none;
  scrollbar-width: none; /* Firefox */
}

body::-webkit-scrollbar, html::-webkit-scrollbar {
  display: none;
}

/**
 * Accessibility: Reduced Motion Support
 * 
 * When user prefers reduced motion:
 * - Re-enable native smooth scroll as fallback
 * - Lenis will detect this and disable itself
 * 
 * This is WCAG 2.1 Level AAA compliant
 */
@media (prefers-reduced-motion: reduce) {
  html {
    scroll-behavior: smooth;
  }
  
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/**
 * Scrollbar Hiding - Clean UI
 * 
 * Hide all scrollbars across the website for a clean look
 */
::-webkit-scrollbar {
  display: none;
}

/* Firefox scrollbar hiding */
* {
  scrollbar-width: none;
}

/**
 * Performance Optimization Classes
 * 
 * Apply these to elements that animate or transform frequently
 * to promote them to GPU layers and prevent layout thrashing
 */
.scroll-optimized {
  will-change: transform;
  transform: translateZ(0);
  backface-visibility: hidden;
}

/**
 * Prevent content shift during scroll
 * Apply to sections to maintain layout stability
 */
[data-scroll-section] {
  position: relative;
  contain: layout style; /* CSS containment for performance */
}

/**
 * Sticky Element Compatibility
 * 
 * Lenis preserves native sticky behavior, but ensure:
 * 1. Parent has explicit height or is in normal flow
 * 2. No overflow: hidden on ancestors
 * 3. Use position: sticky with top/bottom value
 */
.sticky-element {
  position: sticky;
  top: 0;
  z-index: 100;
}

/**
 * Smooth transitions for scroll-linked elements
 * Add to elements that animate based on scroll position
 */
.scroll-linked {
  transition: transform 0.1s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

/**
 * ============================================
 * CUSTOM CURSOR STYLES
 * ============================================
 * 
 * Premium cursor with easing, hover effects, and GPU acceleration
 */

/* Hide default cursor globally - more aggressive rules */
html, 
body, 
*,
*::before,
*::after {
  cursor: none !important;
}

/* Force cursor none on all interactive elements */
a, button, input, textarea, select, label, [role="button"] {
  cursor: none !important;
}

/* Re-enable cursor on touch devices via media query */
@media (pointer: coarse), (hover: none) {
  html, body, * {
    cursor: auto !important;
  }
  
  .custom-cursor {
    display: none !important;
  }
}

/* Custom cursor base styles */
.custom-cursor {
  position: fixed;
  top: 0;
  left: 0;
  width: 32px;
  height: 32px;
  pointer-events: none;
  z-index: 99999;
  opacity: 0;
  will-change: transform, opacity;
  /* Offset to center the cursor on the pointer */
  margin-left: -16px;
  margin-top: -16px;
  /* Fast opacity transition */
  transition: opacity 0.1s ease-out;
  /* Start off-screen to prevent flash at 0,0 */
  transform: translate3d(-100px, -100px, 0);
}

/* Hover state - subtle scale */
.custom-cursor--hover {
  transform: scale(1.2) !important;
}

.custom-cursor--hover .custom-cursor__icon {
  opacity: 0.75;
}

/* Cursor icon */
.custom-cursor__icon {
  width: 100%;
  height: 100%;
  object-fit: contain;
  transition: opacity 0.15s ease-out;
  /* Invert colors for visibility on dark background */
  filter: invert(1);
}

/* Reduced motion support - disable cursor animation */
@media (prefers-reduced-motion: reduce) {
  .custom-cursor {
    display: none !important;
  }
  
  html, body, * {
    cursor: auto !important;
  }
}
